# Хранение данных задач.

Предлагается использовать подход LSM без индекса ключей – он не нужен, т.к. нет потребности доставать произвольную
сессию, они нам нужны только тогда, когда приходит время их восстановления (или повтора для cron/at задач).

Т.е. у нас имеются хранилища в которые складываются данные сессий упорядоченные по времени повтора.

Навскидку, хорошими вариантами хранения являются:

* Упорядоченные структуры в памяти, под это хорошо подходят различные варианты сбалансированных деревьев.
* Файлы со следующей структурой:

    | `repeat1` | `len1` | `data1` | `repeat2` | `len2` | `data2` | ... |
    |-----------|--------|---------|:----------|:-------|:--------|:----|
    
    Где
    
    | Сущность  | Объяснение                        |
    |-----------|-----------------------------------|
    | `repeatN` | время повтора в секундах задачи N |
    | `lenN`    | длина бинарных данных задачи N    |
    | `dataN`   | бинарные данные задачи N          |
    
    И здесь `repeat1 ≤ repeat2 ≤ repeat3 ≤ …`, т.е. записи в файле упорядочены по времени повтора.

Как принято для LSM, данные вначале скидываются в упорядоченные структуры данных, а затем, когда их объём превосходит
пороговый, сбрасываются в файл с вышеописанной структурой.

Как и в стандартном LSM-подходе, разные файлы могут объединяться время от времени, чтобы уменьшалось общее количество
используемых файлов. Критерием необходимости слияния будет являться наличие сессий с повтором достаточно далеко в 
будущем – потому что для близких повторов проще дождаться момента вычитки.

Т.е. источниками сессий являются:

* Данные содержащиеся в структуре с упорядоченными данными в памяти.
* Данные в файлах.



