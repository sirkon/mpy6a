# Работа системы.

У нас есть:

* Кластер реализующий систему.
* Клиенты работающие с кластером.
* Т.н. "сервис восстановления", реализующий некоторую gRPC схему, который участвует в повторе сессий.

## Функционирование системы при получении данных от клиентов.

1. Клиент делает запрос к ноде к которой он подключён.
2. Если нода не является лидером, то она проксирует запрос к лидеру.
3. Лидер принимает запрос, заводит сессию.
4. Происходит взаимодействие клиента с лидером.
5. По результатам сессия либо удаляется, либо сохраняется для повтора позднее.

## Работа для восстановления сессий.

Когда приходит время восстановления сессии

1. Лидер вычитывает сессию в память, что делает её активной.
2. Делает запрос на проигрывание к сервису повторов.
3. Идёт взаимодействие с сервисом повторов точно такое же, как и с клиентом.

## Визуальное представление схемы работы

![схема работы](interaction.png)